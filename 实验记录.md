| **实验日期** | **实验目的**                                       | **实验源目录**                               | **实验结果目录**                               | **测试结果目录**                                    | **实验数据**     | **运行脚本**                                        | **改动地方**                                                 | **存在问题**                                                 | **实验结果**                                                 | **原因分析**                                                 |
| :----------: | -------------------------------------------------- | -------------------------------------------- | ---------------------------------------------- | --------------------------------------------------- | ---------------- | --------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | :----------------------------------------------------------- |
|  2021/5/28   | Baseline  3D RetinaNet                             | Rifrac_RetinaNet_exp                         | Rifrac_RetinaNet_debug                         |                                                     | data_npz         | 无                                                  |                                                              |                                                              |                                                              |                                                              |
|  2021/6/01   | 分割后检测效果会不会提升                           | Rifrac_RetinaNet_segment_exp                 | Rifrac_RetinaNet_segment_debug_bak             |                                                     | data_segmetn_npz | RetinaNet_3D_segment_train.sh                       | 1.将原数据经过传统方法分割后进行检测                         | 1.只是粗略的分割，有很多噪声，比如脊柱、床板                 | 相比于直接训练有提升                                         | 需要进一步验证                                               |
|  2021/6/03   | 网络不收敛，学习率的影响                           | Rifrac_RetinaNet_segment_exp                 | Rifrac_RetinaNet_segment_debug                 |                                                     | data_segmetn_npz | RetinaNet_3D_segment_train.sh                       | 1.降低了10倍学习率，继续训练                                 | 网络不再收敛                                                 | 略有提升                                                     | 说明学习率需要调整为动态的                                   |
|  2021/6/05   | 训练策略的影响，随机采样和只训练有目标的区域的差别 | Rifrac_RetinaNet_segment_exp                 | Rifrac_RetinaNet_segment_roi_debug             |                                                     | patch_image      | exec_rois.py \|  RetinaNet_3D_segment_train_rois.sh | 1.添加了新的数据加载方式  2.只训练有骨折的区域               | 待分析                                                       | 1.实验结果降低20个点                                         | 待分析                                                       |
|  2021/6/10   | anchor的scale和ratio对性能的影响                   | Rifrac_RetinaNet_segment_tunepara_exp        | Rifrac_RetinaNet_segment_tunepara_debug        |                                                     | data_segmetn_npz | RetinaNet_3D_segment_tunepara_train.sh              | 1.z轴的scale:[2,4,8,16]--->[4,8,16,32]  2.ratio:[0.5,1,2]--->[0.7,1,1.4] | 1.anchor的正样本质量不高，大于0.7的很少  2.正负样本严重失衡，甚至到达 67万：2 这样  3.目前用的loss是在线困难挖掘，OHEM | 1.FROC提升两个点     2.FP从4100降到3090     3.Recall略有降低 | 1.正负样本分布比例失衡，正样本数目少     2.对于难分样本分类还不是很好     3.分析图像看不出来啥区别 |
|  2021/6/17   | Focal Loss对性能的提升                             | Rifrac_RetinaNet_segment_floss_exp           | Rifrac_RetinaNet_segment_floss_debug           |                                                     | data_segmetn_npz | RetinaNet_3D_segment_floss_train.sh                 | 分类loss由OHEM改为focal loss                                 | 1.训练所有样本，训练过程中loss为归为0                        | 未调试完                                                     | 有空可以再调试一下                                           |
|  2021/6/19   | 加入seg分支                                        | Rifrac_RetinaNet_segment_seg_exp             | Rifrac_RetinaNet_segment_seg_debug             |                                                     | data_segmetn_npz | RetinaNet_3D_segment_seg_train.sh                   | 测试seg分支                                                  | 1.dice loss太大，不能通过loss曲线观察训练进度  2.分割和检测的loss比例没有确定 | 1.收敛很快     2.性能下降                                    | TODO                                                         |
|  2021/6/22   | 加入seg分支                                        | Rifrac_RetinaNet_segment_boxseg_exp          | Rifrac_RetinaNet_segment_boxseg_debug          | RetinaNet_3D_segment_boxseg                         | data_segmetn_npz | RetinaNet_3D_segment_boxseg_train.sh                | 1.去掉dice loss  2.更换数据集划分                            | 1.loss直接累加，没有出batch求平均  2.分割loss浮动大          | 平均recall降低                                               | 检测性能变差                                                 |
|  2021/6/24   | 加入seg分支，在segment的预训练模型上联合训练       | Rifrac_RetinaNet_segment_boxseg_pretrain_exp | Rifrac_RetinaNet_segment_boxseg_pretrain_debug | RetinaNet_3D_segment_boxseg_pretrain                | data_segmetn_npz | RetinaNet_3D_segment_boxseg_pretrain_train.sh       | 1.加入了segment的预训练模型                                  | 1.分割的loss只对有前景的patch进行计算                        | 1.seg信息对性能有提升，平均recall提升了2                     | 2.需要进一步优化loss   3.如何对检测到的boxs生成的seg         |
|  2021/6/28   | 加入FPD分支                                        | Rifrac_RetinaNet_segment_FPD_pretrain_exp    | Rifrac_RetinaNet_segment_FPD_pretrain_debug    | RetinaNet_3D_segment_FPD2_pretrain  (RPN检测的结果) | data_segmetn_npz | RetinaNet_3D_segment_FPD_pretrain_train.sh          | 在P2层加入了FPD分支                                          | 1.和检测head没有完全解耦  2.推测训练阶段prposal的数目没有确定 | 1.RPN检测的结果提升2个点左右   2.FPD检测的结果               | FPD训练的策略，二分类还是加上回归   解耦   训练策略   检测score |

跑实验之前check几件事：

1.epoch是否对

2.是否需要resume

3.是否更换了数据集划分的列表

4.model是否正确